<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>solver: libLBFGS: a library of Limited-memory Broyden-Fletcher-Goldfarb-Shanno (L-BFGS)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">solver
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">libLBFGS: a library of Limited-memory Broyden-Fletcher-Goldfarb-Shanno (L-BFGS) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>This library is a C port of the implementation of Limited-memory Broyden-Fletcher-Goldfarb-Shanno (L-BFGS) method written by Jorge Nocedal. The original FORTRAN source code is available at: <a href="http://www.ece.northwestern.edu/~nocedal/lbfgs.html">http://www.ece.northwestern.edu/~nocedal/lbfgs.html</a></p>
<p>The L-BFGS method solves the unconstrainted minimization problem,</p>
<pre>
    minimize F(x), x = (x1, x2, ..., xN),
</pre><p>only if the objective function F(x) and its gradient G(x) are computable. The well-known Newton's method requires computation of the inverse of the hessian matrix of the objective function. However, the computational cost for the inverse hessian matrix is expensive especially when the objective function takes a large number of variables. The L-BFGS method iteratively finds a minimizer by approximating the inverse hessian matrix by information from last m iterations. This innovation saves the memory storage and computational time drastically for large-scaled problems.</p>
<p>Among the various ports of L-BFGS, this library provides several features:</p><ul>
<li><b>Optimization with L1-norm (Orthant-Wise Limited-memory Quasi-Newton (OWL-QN) method)</b>: In addition to standard minimization problems, the library can minimize a function F(x) combined with L1-norm |x| of the variables, {F(x) + C |x|}, where C is a constant scalar parameter. This feature is useful for estimating parameters of sparse log-linear models (e.g., logistic regression and maximum entropy) with L1-regularization (or Laplacian prior).</li>
<li><b>Clean C code</b>: Unlike C codes generated automatically by f2c (Fortran 77 into C converter), this port includes changes based on my interpretations, improvements, optimizations, and clean-ups so that the ported code would be well-suited for a C code. In addition to comments inherited from the original code, a number of comments were added through my interpretations.</li>
<li><b>Callback interface</b>: The library receives function and gradient values via a callback interface. The library also notifies the progress of the optimization by invoking a callback function. In the original implementation, a user had to set function and gradient values every time the function returns for obtaining updated values.</li>
<li><b>Thread safe</b>: The library is thread-safe, which is the secondary gain from the callback interface.</li>
<li><b>Cross platform.</b> The source code can be compiled on Microsoft Visual Studio 2010, GNU C Compiler (gcc), etc.</li>
<li><b>Configurable precision</b>: A user can choose single-precision (float) or double-precision (double) accuracy by changing ::LBFGS_FLOAT macro.</li>
<li><b>SSE/SSE2 optimization</b>: This library includes SSE/SSE2 optimization (written in compiler intrinsics) for vector arithmetic operations on Intel/AMD processors. The library uses SSE for float values and SSE2 for double values. The SSE/SSE2 optimization routine is disabled by default.</li>
</ul>
<p>This library is used by:</p><ul>
<li><a href="http://www.chokkan.org/software/crfsuite/">CRFsuite: A fast implementation of Conditional Random Fields (CRFs)</a></li>
<li><a href="http://www.chokkan.org/software/classias/">Classias: A collection of machine-learning algorithms for classification</a></li>
<li><a href="http://www.public.iastate.edu/~gdancik/mlegp/">mlegp: an R package for maximum likelihood estimates for Gaussian processes</a></li>
<li><a href="http://infmath.uibk.ac.at/~matthiasf/imaging2/">imaging2: the imaging2 class library</a></li>
</ul>
<h1><a class="anchor" id="download"></a>
Download</h1>
<ul>
<li><a href="https://github.com/downloads/chokkan/liblbfgs/liblbfgs-1.10.tar.gz">Source code</a></li>
<li><a href="https://github.com/chokkan/liblbfgs">GitHub repository</a></li>
</ul>
<p>libLBFGS is distributed under the term of the <a href="http://opensource.org/licenses/mit-license.php">MIT license</a>.</p>
<h1><a class="anchor" id="modules"></a>
Third-party modules</h1>
<ul>
<li><a href="http://cran.r-project.org/web/packages/lbfgs/index.html">lbfgs: Limited-memory BFGS Optimization (a wrapper for R)</a> maintained by Antonio Coppola.</li>
<li><a href="http://search.cpan.org/~laye/Algorithm-LBFGS-0.16/">Algorithm::LBFGS - Perl extension for L-BFGS</a> maintained by Lei Sun.</li>
<li><a href="http://www.cs.kuleuven.be/~bernd/yap-lbfgs/">YAP-LBFGS (an interface to call libLBFGS from YAP Prolog)</a> maintained by Bernd Gutmann.</li>
</ul>
<h1><a class="anchor" id="changelog"></a>
History</h1>
<ul>
<li>Version 1.10 (2010-12-22):<ul>
<li>Fixed compiling errors on Mac OS X; this patch was kindly submitted by Nic Schraudolph.</li>
<li>Reduced compiling warnings on Mac OS X; this patch was kindly submitted by Tamas Nepusz.</li>
<li>Replaced memalign() with posix_memalign().</li>
<li>Updated solution and project files for Microsoft Visual Studio 2010.</li>
</ul>
</li>
<li>Version 1.9 (2010-01-29):<ul>
<li>Fixed a mistake in checking the validity of the parameters "ftol" and "wolfe"; this was discovered by Kevin S. Van Horn.</li>
</ul>
</li>
<li>Version 1.8 (2009-07-13):<ul>
<li>Accepted the patch submitted by Takashi Imamichi; the backtracking method now has three criteria for choosing the step length:<ul>
<li>::LBFGS_LINESEARCH_BACKTRACKING_ARMIJO: sufficient decrease (Armijo) condition only</li>
<li>::LBFGS_LINESEARCH_BACKTRACKING_WOLFE: regular Wolfe condition (sufficient decrease condition + curvature condition)</li>
<li>::LBFGS_LINESEARCH_BACKTRACKING_STRONG_WOLFE: strong Wolfe condition</li>
</ul>
</li>
<li>Updated the documentation to explain the above three criteria.</li>
</ul>
</li>
<li>Version 1.7 (2009-02-28):<ul>
<li>Improved OWL-QN routines for stability.</li>
<li>Removed the support of OWL-QN method in MoreThuente algorithm because it accidentally fails in early stages of iterations for some objectives. Because of this change, <b>the OW-LQN method must be used with the backtracking algorithm (::LBFGS_LINESEARCH_BACKTRACKING)</b>, or the library returns ::LBFGSERR_INVALID_LINESEARCH.</li>
<li>Renamed line search algorithms as follows:<ul>
<li>::LBFGS_LINESEARCH_BACKTRACKING: regular Wolfe condition.</li>
<li>::LBFGS_LINESEARCH_BACKTRACKING_LOOSE: regular Wolfe condition.</li>
<li>::LBFGS_LINESEARCH_BACKTRACKING_STRONG: strong Wolfe condition.</li>
</ul>
</li>
<li>Source code clean-up.</li>
</ul>
</li>
<li>Version 1.6 (2008-11-02):<ul>
<li>Improved line-search algorithm with strong Wolfe condition, which was contributed by Takashi Imamichi. This routine is now default for ::LBFGS_LINESEARCH_BACKTRACKING. The previous line search algorithm with regular Wolfe condition is still available as ::LBFGS_LINESEARCH_BACKTRACKING_LOOSE.</li>
<li>Configurable stop index for L1-norm computation. A member variable ::lbfgs_parameter_t::orthantwise_end was added to specify the index number at which the library stops computing the L1 norm of the variables. This is useful to prevent some variables from being regularized by the OW-LQN method.</li>
<li>A sample program written in C++ (sample/sample.cpp).</li>
</ul>
</li>
<li>Version 1.5 (2008-07-10):<ul>
<li>Configurable starting index for L1-norm computation. A member variable ::lbfgs_parameter_t::orthantwise_start was added to specify the index number from which the library computes the L1 norm of the variables. This is useful to prevent some variables from being regularized by the OWL-QN method.</li>
<li>Fixed a zero-division error when the initial variables have already been a minimizer (reported by Takashi Imamichi). In this case, the library returns ::LBFGS_ALREADY_MINIMIZED status code.</li>
<li>Defined ::LBFGS_SUCCESS status code as zero; removed unused constants, LBFGSFALSE and LBFGSTRUE.</li>
<li>Fixed a compile error in an implicit down-cast.</li>
</ul>
</li>
<li>Version 1.4 (2008-04-25):<ul>
<li>Configurable line search algorithms. A member variable ::lbfgs_parameter_t::linesearch was added to choose either MoreThuente method (::LBFGS_LINESEARCH_MORETHUENTE) or backtracking algorithm (::LBFGS_LINESEARCH_BACKTRACKING).</li>
<li>Fixed a bug: the previous version did not compute psuedo-gradients properly in the line search routines for OWL-QN. This bug might quit an iteration process too early when the OWL-QN routine was activated (0 &lt; ::lbfgs_parameter_t::orthantwise_c).</li>
<li>Configure script for POSIX environments.</li>
<li>SSE/SSE2 optimizations with GCC.</li>
<li>New functions ::lbfgs_malloc and ::lbfgs_free to use SSE/SSE2 routines transparently. It is uncessary to use these functions for libLBFGS built without SSE/SSE2 routines; you can still use any memory allocators if SSE/SSE2 routines are disabled in libLBFGS.</li>
</ul>
</li>
<li>Version 1.3 (2007-12-16):<ul>
<li>An API change. An argument was added to <a class="el" href="LbfgsSolver_8hpp.html#aeed43c3426a6927c3efa9fa34d537f98" title="Start a L-BFGS optimization. ">lbfgs()</a> function to receive the final value of the objective function. This argument can be set to <code>NULL</code> if the final value is unnecessary.</li>
<li>Fixed a null-pointer bug in the sample code (reported by Takashi Imamichi).</li>
<li>Added build scripts for Microsoft Visual Studio 2005 and GCC.</li>
<li>Added README file.</li>
</ul>
</li>
<li>Version 1.2 (2007-12-13):<ul>
<li>Fixed a serious bug in orthant-wise L-BFGS. An important variable was used without initialization.</li>
</ul>
</li>
<li>Version 1.1 (2007-12-01):<ul>
<li>Implemented orthant-wise L-BFGS.</li>
<li>Implemented <a class="el" href="LbfgsSolver_8hpp.html#a0958781b11a057c3e6739f765e225aec" title="Initialize L-BFGS parameters to the default values. ">lbfgs_parameter_init()</a> function.</li>
<li>Fixed several bugs.</li>
<li>API documentation.</li>
</ul>
</li>
<li>Version 1.0 (2007-09-20):<ul>
<li>Initial release.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="api"></a>
Documentation</h1>
<ul>
<li>libLBFGS API</li>
</ul>
<h1><a class="anchor" id="sample"></a>
Sample code</h1>
<div class="fragment"></div><!-- fragment --><h1><a class="anchor" id="ack"></a>
Acknowledgements</h1>
<p>The L-BFGS algorithm is described in:</p><ul>
<li>Jorge Nocedal. Updating Quasi-Newton Matrices with Limited Storage. <em>Mathematics of Computation</em>, Vol. 35, No. 151, pp. 773&ndash;782, 1980.</li>
<li>Dong C. Liu and Jorge Nocedal. On the limited memory BFGS method for large scale optimization. <em>Mathematical Programming</em> B, Vol. 45, No. 3, pp. 503-528, 1989.</li>
</ul>
<p>The line search algorithms used in this implementation are described in:</p><ul>
<li>John E. Dennis and Robert B. Schnabel. <em>Numerical Methods for Unconstrained Optimization and Nonlinear Equations</em>, Englewood Cliffs, 1983.</li>
<li>Jorge J. More and David J. Thuente. Line search algorithm with guaranteed sufficient decrease. <em>ACM Transactions on Mathematical Software (TOMS)</em>, Vol. 20, No. 3, pp. 286-307, 1994.</li>
</ul>
<p>This library also implements Orthant-Wise Limited-memory Quasi-Newton (OWL-QN) method presented in:</p><ul>
<li>Galen Andrew and Jianfeng Gao. Scalable training of L1-regularized log-linear models. In <em>Proceedings of the 24th International Conference on Machine Learning (ICML 2007)</em>, pp. 33-40, 2007.</li>
</ul>
<p>Special thanks go to:</p><ul>
<li>Yoshimasa Tsuruoka and Daisuke Okanohara for technical information about OWL-QN</li>
<li>Takashi Imamichi for the useful enhancements of the backtracking method</li>
<li>Kevin S. Van Horn, Nic Schraudolph, and Tamas Nepusz for bug fixes</li>
</ul>
<p>Finally I would like to thank the original author, Jorge Nocedal, who has been distributing the effieicnt and explanatory implementation in an open source licence.</p>
<h1><a class="anchor" id="reference"></a>
Reference</h1>
<ul>
<li><a href="http://www.ece.northwestern.edu/~nocedal/lbfgs.html">L-BFGS</a> by Jorge Nocedal.</li>
<li><a href="http://research.microsoft.com/en-us/downloads/b1eb1016-1738-4bd5-83a9-370c9d498a03/default.aspx">Orthant-Wise Limited-memory Quasi-Newton Optimizer for L1-regularized Objectives</a> by Galen Andrew.</li>
<li><a href="http://chasen.org/~taku/software/misc/lbfgs/">C port (via f2c)</a> by Taku Kudo.</li>
<li><a href="http://www.alglib.net/optimization/lbfgs.php">C#/C++/Delphi/VisualBasic6 port</a> in ALGLIB.</li>
<li><a href="http://cctbx.sourceforge.net/">Computational Crystallography Toolbox</a> includes <a href="http://cctbx.sourceforge.net/current_cvs/c_plus_plus/namespacescitbx_1_1lbfgs.html">scitbx::lbfgs</a>. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
